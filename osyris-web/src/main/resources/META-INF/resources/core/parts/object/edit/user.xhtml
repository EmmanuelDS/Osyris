<div xmlns="http://www.w3.org/1999/xhtml"
	xmlns:u="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:d="http://specto.gim.be/display"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:r="http://richfaces.org/rich"
	xmlns:a="http://richfaces.org/a4j"
	xmlns:p="http://primefaces.org/ui"
	xmlns:j="http://conscientia.org/jsf"
	xmlns:cc="http://java.sun.com/jsf/composite">
	<cc:interface componentType="org.conscientia.ui.ModelObject" />
	<cc:implementation>
		<j:bind var="c" />
		<r:tabPanel switchType="ajax"
			styleClass="model-propertyGroups"
			contentClass="model-propertyGroup">
			<r:tab header="#{messages['page.user.profile']}">
			<div class="#{cc.attrs.contentClass}">
			
			<div style="float: right">
				<j:commandButton value="#{messages['page.user.password.title']}"
					image="#{resource['core/images/actions/12x12/login.png']}"
					type="button">
					<j:renderListener target="passwordPanel" 
						rendered="true"
						execute="@this" />
				</j:commandButton>
				<j:commandButton value="#{messages['page.user.admin.title']}"
					rendered="#{identity.inGroup('admin', 'CUSTOM')}"
					image="#{resource['core/images/actions/12x12/preferences.png']}"
					type="button">
					<j:renderListener target="adminPanel" 
						rendered="true"
						execute="@this" />
				</j:commandButton>
			</div>
			<d:aspect id="profile"
				value="#{c.attrs.value.getAspect('UserProfile', modelRepository, true)}"
				mode="#{c.attrs.mode}"
				level="#{c.attrs.level}"/>
			
			<div style="display: none">
				<u:decorate template="/resources/core/includes/userPanels.xhtml">
					<u:param name="form"
						value="#{c}" />
				</u:decorate>
			</div>
		</div>
		</r:tab>
		
		<r:tab header="Peter/Meter"
				rendered="#{(identity.inGroup('Routedokter', 'CUSTOM') or
							 identity.inGroup('Medewerker','CUSTOM') or 
							 identity.inGroup('PeterMeter','CUSTOM') or
							 identity.inGroup('admin','CUSTOM')) and userRepository.listGroupnames(cc.attrs.value.username).contains('PeterMeter')}">
				<a:outputPanel>
					<d:aspect id="peterMeterProfile"
						value="#{cc.attrs.value.getAspect('PeterMeterProfiel', modelRepository, userRepository.listGroupnames(cc.attrs.value.username).contains('PeterMeter'))}"
						mode="#{cc.attrs.mode}"
						level="#{cc.attrs.level}"/>
				</a:outputPanel>
				
				<a:outputPanel rendered="#{userRepository.listGroupnames(cc.attrs.value.username).contains('PeterMeter')}">    
					<u:decorate template="/resources/osyris/includes/_toegewezenTrajecten.xhtml" >
					<u:param name="username"
							value="#{cc.attrs.value.username}" />
				</u:decorate>
				</a:outputPanel>
				
			</r:tab>
			
			<r:tab header="Bedrijf"
				rendered="#{(identity.inGroup('Routedokter', 'CUSTOM') or 
							 identity.inGroup('Uitvoerder','CUSTOM') or 
							 identity.inGroup('admin','CUSTOM')) and userRepository.listGroupnames(cc.attrs.value.username).contains('Uitvoerder')}">
				<a:outputPanel>
					<d:aspect id="uitvoerderProfile"
						value="#{cc.attrs.value.getAspect('UitvoerderProfiel', modelRepository, userRepository.listGroupnames(cc.attrs.value.username).contains('Uitvoerder'))}"
						mode="#{cc.attrs.mode}"
						level="#{cc.attrs.level}"/>
				</a:outputPanel>
			</r:tab>
			
			<r:tab header="Trajectverantwoordelijkheid"
				rendered="#{(identity.inGroup('Routedokter', 'CUSTOM') or 
							 identity.inGroup('Medewerker','CUSTOM') or 
							 identity.inGroup('admin','CUSTOM')) and userRepository.listGroupnames(cc.attrs.value.username).contains('Medewerker')}">
				<a:outputPanel>
					<d:aspect id="medewerkerProfile"
						value="#{cc.attrs.value.getAspect('MedewerkerProfiel', modelRepository, userRepository.listGroupnames(cc.attrs.value.username).contains('Medewerker'))}"
						mode="#{cc.attrs.mode}"
						level="#{cc.attrs.level}"/>
				</a:outputPanel>
			</r:tab>	
		</r:tabPanel>			
		
	</cc:implementation>
</div>