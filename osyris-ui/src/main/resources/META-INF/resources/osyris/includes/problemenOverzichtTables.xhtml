<u:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:u="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:a="http://richfaces.org/a4j" 
	xmlns:r="http://richfaces.org/rich"
	xmlns:d="http://specto.gim.be/display"
	xmlns:j="http://conscientia.org/jsf" 
	xmlns:m="http://specto.gim.be/map"
	xmlns:p="http://primefaces.org/ui">
	<r:panel id="problemenOverzichtPanel">
		<p:dataTable id="bordProblemen"
			value="#{form.bordProblemen}"
			mode="RESULT"
			var="bordProbleem"
			styleClass="model-table #{cc.attrs.contentClass}"
			paginator="true"
			rows="5"
			paginatorPosition="bottom"
			paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
			emptyMessage="#{messages['ui.dataTable.empty']}">
			<j:bindAttribute var="bordProbleem"
						name="rowData" />
			<f:facet name="header">
				<div>Bordproblemen</div>
			</f:facet>
			<p:column style="width:2%">
				<j:commandButton
					src="#{resource['core/images/actions/16x16/zoom.png']}"
					type="image"
					title="#{messages['component.map.zoomToFeature.label']}"
					action="#{form.zoomToBordProbleem(bordProbleem)}" />
				<j:commandButton rendered="#{form.object.status == 'UIT_TE_VOEREN'}"
					src="#{resource['core/images/actions/16x16/delete.png']}"
					type="image"
					title="Probleem verwijderen"
					oncomplete="conscientia.widget(#{r:element('removeProbleemPopup')}).show();">
							<f:setPropertyActionListener
								target="#{form.selectedProbleem}"
								value="#{bordProbleem}" />
							</j:commandButton>
	   		</p:column>
	   		<c:if test="#{form.isRouteBord(bordProbleem.bord)}">
	   		<p:column>
				<f:facet name="header">
				<div>Bord</div>
				</f:facet>
					<h:outputText value="#{osyrisModelFunctions.getBordVolg(bordProbleem.bord) }" mode="VIEW" />
			</p:column>
			</c:if>
			<c:if test="#{!form.isRouteBord(bordProbleem.bord)}">
			<p:column>
				<f:facet name="header">
				<div>Bord ID</div>
				</f:facet>
					<h:outputText value= "#{d:modelObject(bord).getId()}" mode="VIEW" />
			</p:column>
			</c:if>
			<p:column>
				<f:facet name="header">
				<div>Type</div>
				</f:facet>
				<d:propertyValue id="typeColumn"
					modelProperty="#{d:modelClass('Probleem').getProperty('type')}"
					value="#{bordProbleem.type}"
					mode="VIEW" />
			</p:column>
			<p:column>
				<f:facet name="header">
				<div>Commentaar</div>
				</f:facet>
				<d:propertyValue id="commentaarColumn"
					modelProperty="#{d:modelClass('Probleem').getProperty('commentaar')}"
					value="#{bordProbleem.commentaar}"
					mode="VIEW" />
			</p:column>
			<p:column rendered="#{identity.inGroup('Medewerker','CUSTOM') or identity.inGroup('Routedokter','CUSTOM') or identity.inGroup('admin','CUSTOM') }">
				<f:facet name="header">
				<div>Status</div>
				</f:facet>
				<d:propertyValue id="statusColumn"
					modelProperty="#{d:modelClass('Probleem').getProperty('status')}"
					value="#{bordProbleem.status}"
					mode="VIEW" />
			</p:column>
			<p:column rendered="#{(identity.inGroup('Medewerker','CUSTOM') or identity.inGroup('Routedokter','CUSTOM') or identity.inGroup('admin','CUSTOM')) and form.object.status == 'GERAPPORTEERD'}">
				<j:commandButton
					image="#{resource['core/images/actions/16x16/edit.png']}"
					type="image"
					title="Valideren probleem"
					oncomplete="conscientia.widget(#{r:element('editProbleemPopup')}).show();">
					<f:setPropertyActionListener
						target="#{form.selectedProbleem}"
						value="#{bordProbleem}" />
				</j:commandButton>
			</p:column>
	   	</p:dataTable>
	   	
	   	<br/>
  		
	   	<p:dataTable id="AndereProblemen"
			value="#{form.getAndereProblemen()}"
			mode="RESULT"
			var="anderProbleem"
			styleClass="model-table #{cc.attrs.contentClass}"
			paginator="true"
			rows="5"
			paginatorPosition="bottom"
			paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
			emptyMessage="#{messages['ui.dataTable.empty']}">
			<j:bindAttribute var="anderProbleem"
						name="rowData" />
			<f:facet name="header">
				<div>Andere problemen</div>
			</f:facet>
			<p:column style="width:2%">
				<j:commandButton
					src="#{resource['core/images/actions/16x16/zoom.png']}"
					type="image"
					title="#{messages['component.map.zoomToFeature.label']}"
					action="#{form.zoomToAnderProbleem(anderProbleem)}" />
				<j:commandButton rendered="#{form.object.status == 'UIT_TE_VOEREN'}"
					src="#{resource['core/images/actions/16x16/delete.png']}"
					type="image"
					title="Probleem verwijderen"
					oncomplete="conscientia.widget(#{r:element('removeProbleemPopup')}).show();">
							<f:setPropertyActionListener
								target="#{form.selectedProbleem}"
								value="#{anderProbleem}" />
							</j:commandButton>
	   		</p:column>
	   		<p:column>
				<f:facet name="header">
				<div>Categorie</div>
				</f:facet>
				<d:propertyValue id="categorieColumn"
					modelProperty="#{d:modelClass('Probleem').getProperty('categorie')}"
					value="#{anderProbleem.categorie}"
					mode="VIEW" />
			</p:column>
			<p:column>
				<f:facet name="header">
				<div>Commentaar</div>
				</f:facet>
				<d:propertyValue id="commentaarColumn"
					modelProperty="#{d:modelClass('Probleem').getProperty('commentaar')}"
					value="#{anderProbleem.commentaar}"
					mode="VIEW" />
			</p:column>
			<p:column rendered="#{identity.inGroup('Medewerker','CUSTOM') or identity.inGroup('Routedokter','CUSTOM') or identity.inGroup('admin','CUSTOM') }">
				<f:facet name="header">
				<div>Status</div>
				</f:facet>
				<d:propertyValue id="statusColumn"
					modelProperty="#{d:modelClass('Probleem').getProperty('status')}"
					value="#{anderProbleem.status}" mode="VIEW" />
			</p:column>
			<p:column rendered="#{(identity.inGroup('Medewerker','CUSTOM') or identity.inGroup('Routedokter','CUSTOM') or identity.inGroup('admin','CUSTOM')) and form.object.status == 'GERAPPORTEERD'}">
				<j:commandButton
					rendered="#{identity.inGroup('Medewerker','CUSTOM') or identity.inGroup('Routedokter','CUSTOM') or identity.inGroup('admin','CUSTOM') }"
					image="#{resource['core/images/actions/16x16/edit.png']}"
					type="image"
					title="Valideren Probleem"
					oncomplete="conscientia.widget(#{r:element('editProbleemPopup')}).show();">
					<f:setPropertyActionListener
						target="#{form.selectedProbleem}"
						value="#{anderProbleem}" />
				</j:commandButton>
			</p:column>
   		</p:dataTable>
	</r:panel>
</u:composition>